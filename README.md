IDENTIFICATION DIVISION.
PROGRAM-ID. Act3.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 FIXED-SHIFT PIC S9(4) VALUE +5.
01 TEXTS PIC X(100).
01 ENCRYPTED-TEXTS PIC X(100).
01 I PIC 9.
01 C PIC X.
01 BASE PIC X VALUE 'A'.
01 ENCRYPTED-CHAR PIC 99.

PROCEDURE DIVISION.
DISPLAY "Enter the text to Encrypt: " WITH NO ADVANCING.
ACCEPT TEXTS.
PERFORM ENCRYPT-TEXTS.
DISPLAY "Output text: " ENCRYPTED-TEXTS.
STOP RUN.

ENCRYPT-TEXTS.
PERFORM VARYING I FROM 1 BY 1 UNTIL I > FUNCTION LENGTH(TEXTS)
MOVE TEXTS(I:1) TO C
IF C IS ALPHABETIC
COMPUTE ENCRYPTED-CHAR = FUNCTION MOD((FUNCTION ORD(C) - FUNCTION ORD(BASE) + FIXED-SHIFT), 26) + FUNCTION ORD(BASE)
STRING ENCRYPTED-CHAR DELIMITED BY SIZE INTO ENCRYPTED-TEXTS
ELSE
STRING C DELIMITED BY SIZE INTO ENCRYPTED-TEXTS
END-IF
END-PERFORM.
